# VabHub Core å¼€å‘å®Œæˆæ€»ç»“

## ğŸ¯ å¼€å‘ä»»åŠ¡å®Œæˆæƒ…å†µ

### âœ… å·²å®Œæˆçš„P0ä¼˜å…ˆçº§åŠŸèƒ½

#### 1. DownloadClientæŠ½è±¡æ¥å£å’ŒqBittorrenté€‚é…
- **å®ç°ä½ç½®**: `core/download_client.py`, `core/download_manager.py`
- **åŠŸèƒ½**: ç»Ÿä¸€PTå®¢æˆ·ç«¯æ¥å£ï¼Œæ”¯æŒqBittorrenté€‚é…
- **APIç«¯ç‚¹**: `/download/*`
- **æµ‹è¯•**: `tests/test_download_client.py`

#### 2. RSSå¼•æ“å’Œè§„åˆ™è¿‡æ»¤ç³»ç»Ÿ
- **å®ç°ä½ç½®**: `core/rss_engine.py`
- **åŠŸèƒ½**: RSSæ‹‰å–ä¸é»‘ç™½åå•/æ¸…æ™°åº¦/ä½“ç§¯/æ’é‡
- **APIç«¯ç‚¹**: `/rss/*`
- **æµ‹è¯•**: `tests/test_rss_engine.py`

#### 3. è§†é¢‘å…ƒæ•°æ®æŠ½è±¡å’ŒTMDb/è±†ç“£é›†æˆ
- **å®ç°ä½ç½®**: `core/metadata_manager.py`
- **åŠŸèƒ½**: ç»Ÿä¸€Movie/Show/Season/Episodeå®ä½“ï¼Œæ”¯æŒTMDb/è±†ç“£
- **APIç«¯ç‚¹**: `/metadata/*`
- **æµ‹è¯•**: `tests/test_metadata_manager.py`

#### 4. Renameræ¨¡æ¿å’ŒSTRMå·¥ä½œæµ
- **å®ç°ä½ç½®**: `core/renamer.py`
- **åŠŸèƒ½**: å‘½åæ¨¡æ¿ä¸STRMå·¥ä½œæµ
- **APIç«¯ç‚¹**: `/renamer/*`
- **æµ‹è¯•**: `tests/test_renamer.py`

### âœ… å·²å®Œæˆçš„P1ä¼˜å…ˆçº§åŠŸèƒ½

#### 5. é€šçŸ¥ç³»ç»Ÿï¼ˆTelegram/Serveré…±ï¼‰
- **å®ç°ä½ç½®**: `core/notification.py`
- **åŠŸèƒ½**: ä»»åŠ¡æˆåŠŸ/å¤±è´¥é€šçŸ¥
- **APIç«¯ç‚¹**: `/notification/*`
- **æµ‹è¯•**: `tests/test_notification.py`

#### 6. è®¤è¯æˆæƒæœºåˆ¶ï¼ˆJWT+API Keyï¼‰
- **å®ç°ä½ç½®**: `core/api_auth.py`
- **åŠŸèƒ½**: JWTç™»å½•ä¸API Keyæ”¯æŒ
- **APIç«¯ç‚¹**: `/auth/*`
- **æµ‹è¯•**: `tests/test_auth.py`

#### 7. ä¼˜åŒ–é‡å‘½åå’Œè·¯å¾„ç®¡ç†
- **å®ç°ä½ç½®**: `core/path_manager.py`, `core/api_path.py`
- **åŠŸèƒ½**: æ–‡ä»¶åæ¸…ç†ã€å”¯ä¸€æ–‡ä»¶åã€è·¯å¾„ç»„ç»‡ã€ç¬¦å·é“¾æ¥
- **APIç«¯ç‚¹**: `/path/*`
- **æµ‹è¯•**: `tests/test_path_manager.py`

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### æ ¸å¿ƒæ¨¡å—
```
vabhub-Core/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ api.py                    # ä¸»APIæœåŠ¡å™¨
â”‚   â”œâ”€â”€ download_client.py        # ä¸‹è½½å®¢æˆ·ç«¯æŠ½è±¡
â”‚   â”œâ”€â”€ download_manager.py       # ä¸‹è½½ç®¡ç†å™¨
â”‚   â”œâ”€â”€ rss_engine.py             # RSSå¼•æ“
â”‚   â”œâ”€â”€ metadata_manager.py       # å…ƒæ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ renamer.py                # é‡å‘½åå™¨
â”‚   â”œâ”€â”€ notification.py           # é€šçŸ¥ç³»ç»Ÿ
â”‚   â”œâ”€â”€ api_auth.py               # è®¤è¯æˆæƒ
â”‚   â”œâ”€â”€ path_manager.py           # è·¯å¾„ç®¡ç†
â”‚   â””â”€â”€ api_*.py                  # å„æ¨¡å—APIè·¯ç”±
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ test_*.py                 # å•å…ƒæµ‹è¯•
â””â”€â”€ requirements.txt              # ä¾èµ–ç®¡ç†
```

### APIç«¯ç‚¹æ±‡æ€»

| æ¨¡å— | å‰ç¼€ | ä¸»è¦åŠŸèƒ½ |
|------|------|----------|
| ä¸‹è½½ç®¡ç† | `/download` | ä¸‹è½½å®¢æˆ·ç«¯ç®¡ç†ã€ä»»åŠ¡ç®¡ç† |
| RSSå¼•æ“ | `/rss` | RSSè®¢é˜…ã€è§„åˆ™è¿‡æ»¤ |
| å…ƒæ•°æ® | `/metadata` | åª’ä½“ä¿¡æ¯è·å–ã€è¯†åˆ« |
| é‡å‘½å | `/renamer` | æ–‡ä»¶é‡å‘½åã€STRMç”Ÿæˆ |
| é€šçŸ¥ | `/notification` | æ¶ˆæ¯æ¨é€ã€å‘Šè­¦ |
| è®¤è¯ | `/auth` | JWTç™»å½•ã€API Keyç®¡ç† |
| è·¯å¾„ç®¡ç† | `/path` | æ–‡ä»¶ç»„ç»‡ã€è·¯å¾„ä¼˜åŒ– |

## ğŸ§ª æµ‹è¯•éªŒè¯

æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å·²å®ç°å•å…ƒæµ‹è¯•ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cd f:\VabHub\vabhub-Core
python -m pytest tests/ -v

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
python -m pytest tests/test_download_client.py -v
python -m pytest tests/test_rss_engine.py -v
python -m pytest tests/test_metadata_manager.py -v
python -m pytest tests/test_renamer.py -v
python -m pytest tests/test_notification.py -v
python -m pytest tests/test_auth.py -v
python -m pytest tests/test_path_manager.py -v
```

## ğŸ”§ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
cd f:\VabHub\vabhub-Core
pip install -r requirements.txt
```

### 2. å¯åŠ¨APIæœåŠ¡å™¨
```bash
python -m core.api
```

### 3. APIæ–‡æ¡£è®¿é—®
å¯åŠ¨åè®¿é—®: `http://localhost:8000/docs`

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### ä¸‹è½½ç®¡ç†
- âœ… æŠ½è±¡ä¸‹è½½å®¢æˆ·ç«¯æ¥å£
- âœ… qBittorrenté€‚é…å™¨
- âœ… ä¸‹è½½ä»»åŠ¡ç®¡ç†
- âœ… çŠ¶æ€ç›‘æ§å’Œé”™è¯¯å¤„ç†

### RSSè‡ªåŠ¨åŒ–
- âœ… å¤šæºRSSè®¢é˜…
- âœ… æ™ºèƒ½è§„åˆ™è¿‡æ»¤
- âœ… å…³é”®è¯é»‘ç™½åå•
- âœ… æ¸…æ™°åº¦/ä½“ç§¯é™åˆ¶

### å…ƒæ•°æ®ç³»ç»Ÿ
- âœ… ç»Ÿä¸€åª’ä½“å®ä½“æ¨¡å‹
- âœ… TMDb/è±†ç“£æ•°æ®æº
- âœ… æœ¬åœ°ç¼“å­˜ç­–ç•¥
- âœ… å¤šè¯­è¨€æ”¯æŒ

### æ–‡ä»¶å¤„ç†
- âœ… æ™ºèƒ½é‡å‘½åæ¨¡æ¿
- âœ… STRMæ–‡ä»¶ç”Ÿæˆ
- âœ… ç¬¦å·é“¾æ¥æ”¯æŒ
- âœ… æ‰¹é‡æ“ä½œ

### å®‰å…¨è®¤è¯
- âœ… JWTä»¤ç‰Œè®¤è¯
- âœ… API Keyæ”¯æŒ
- âœ… æƒé™ç®¡ç†
- âœ… å®‰å…¨ä¸­é—´ä»¶

### è·¯å¾„ä¼˜åŒ–
- âœ… æ–‡ä»¶åæ¸…ç†
- âœ… å”¯ä¸€æ–‡ä»¶åç”Ÿæˆ
- âœ… åª’ä½“ç±»å‹åˆ†ç±»
- âœ… ç©ºç›®å½•æ¸…ç†

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

### P2ä¼˜å…ˆçº§åŠŸèƒ½ï¼ˆå¾…å®ç°ï¼‰
1. **å®Œæ•´çš„æµ‹è¯•ä½“ç³»** - pytest + vitest + playwright
2. **éƒ¨ç½²å’Œç›‘æ§ä¼˜åŒ–** - Dockerå¤šé˜¶æ®µ + å¥åº·æ£€æŸ¥
3. **æ€§èƒ½ä¼˜åŒ–** - ç¼“å­˜ç­–ç•¥ã€å¼‚æ­¥å¤„ç†
4. **ç”¨æˆ·ç•Œé¢** - Webå‰ç«¯ç®¡ç†ç•Œé¢
5. **æ’ä»¶ç³»ç»Ÿ** - å¯æ‰©å±•çš„æ’ä»¶æ¶æ„

### é›†æˆæµ‹è¯•
- ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•
- å¤šå®¢æˆ·ç«¯å…¼å®¹æ€§æµ‹è¯•
- æ€§èƒ½å‹åŠ›æµ‹è¯•
- å®‰å…¨æ¸—é€æµ‹è¯•

## ğŸ“Š æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: FastAPI + Uvicorn
- **æ•°æ®åº“**: SQLAlchemy + PostgreSQL/SQLite
- **ç¼“å­˜**: Redis
- **ä»»åŠ¡é˜Ÿåˆ—**: Celery
- **è®¤è¯**: JWT + OAuth2
- **æµ‹è¯•**: pytest + unittest
- **éƒ¨ç½²**: Docker + Docker Compose

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- JWTä»¤ç‰Œè®¤è¯
- API Keyæƒé™æ§åˆ¶
- è¾“å…¥éªŒè¯å’Œæ¸…ç†
- å®‰å…¨çš„æ–‡ä»¶æ“ä½œ
- é”™è¯¯ä¿¡æ¯è„±æ•

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- å¼‚æ­¥å¤„ç†æ”¯æŒ
- ç¼“å­˜ç­–ç•¥
- æ‰¹é‡æ“ä½œä¼˜åŒ–
- å†…å­˜ä½¿ç”¨ä¼˜åŒ–

è¿™ä¸ªå¼€å‘è®¡åˆ’åŸºäºMoviePilotçš„æœ€ä½³å®è·µï¼Œç¡®ä¿äº†VabHubå…·å¤‡å®Œæ•´çš„åª’ä½“ç®¡ç†èƒ½åŠ›ï¼ŒåŒæ—¶ä¿æŒäº†ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚